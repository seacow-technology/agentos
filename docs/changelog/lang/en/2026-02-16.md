# 2026-02-16: WebUI Product Surface Refresh, Context Optimizer v2, and LLM Usage/Price Observability

This release introduces a product-oriented WebUI surface in desktop packaging, ships context optimization pipelines (including v2 budget/signature flow), and adds LLM usage + model pricing persistence for better runtime cost visibility.

## Commit Evidence (Master)

```text
f518b952  feat(webui): batch integrate pending changes before v3.5.0 release
```

## 1) WebUI/Product Surface Updates

Delivered:
- Added product API surface and routing in WebUI backend.
- Added/updated WebUI pages and UX flows, including AWS ops entry, provider pricing dialog, and model/provider/chat related updates.
- Expanded i18n dictionaries and key registry for the new UI surfaces.

Key files:
- `apps/webui/src/pages/AwsOpsPage.tsx`
- `apps/webui/src/components/providers/ModelPricingDialog.tsx`
- `apps/webui/src/pages/ModelsPage.tsx`
- `apps/webui/src/pages/ProvidersPage.tsx`
- `apps/webui/src/pages/ChatPage.tsx`
- `apps/webui/src/ui/text/dict.en.ts`
- `apps/webui/src/ui/text/dict.zh.ts`
- `apps/webui/src/ui/text/keys.ts`
- `os/octopusos/webui/api/product.py`
- `os/octopusos/webui/contract/router_registry.py`

## 2) Context Optimizer v1/v2 Pipeline (CLI/Tool/UI)

Delivered:
- Introduced `context_optimizer` module with rule-based optimization for CLI/tool/UI streams.
- Added v2 pipeline components: budget allocator, context pack builder, pointer resolver, semantic validator, signature/signature-store, and evaluation helpers.
- Added WebUI API entry for optimizer invocation.

Key files:
- `os/octopusos/core/context_optimizer/pipeline.py`
- `os/octopusos/core/context_optimizer/rules/cli_optimizer.py`
- `os/octopusos/core/context_optimizer/rules/tool_optimizer.py`
- `os/octopusos/core/context_optimizer/rules/ui_optimizer.py`
- `os/octopusos/core/context_optimizer/v2/budget_allocator.py`
- `os/octopusos/core/context_optimizer/v2/context_pack_builder.py`
- `os/octopusos/core/context_optimizer/v2/semantic_validator.py`
- `os/octopusos/core/context_optimizer/v2/signature_store.py`
- `os/octopusos/webui/api/context_optimizer.py`
- `tests/unit/context_optimizer/*`

## 3) LLM Usage Events + Model Pricing Persistence

Delivered:
- Added usage event model/storage path and pricing utilities in LLM core.
- Added DB schema migrations for usage events and model pricing tables.
- Added smoke/unit tests around usage event reporting paths.

Key files:
- `os/octopusos/core/llm/usage_events.py`
- `os/octopusos/core/llm/pricing.py`
- `os/octopusos/store/migrations/schema_v101_llm_usage_events.sql`
- `os/octopusos/store/migrations/schema_v102_llm_model_pricing.sql`
- `tests/unit/llm/test_llm_usage_events.py`

## 4) Desktop Packaging Resource Shift

Delivered:
- Added desktop bundled `product-dist` resources.
- Reworked desktop runtime/webui integration paths in Electron main/preload/proxy/sidecars.

Key files:
- `apps/desktop-electron/resources/product-dist/index.html`
- `apps/desktop-electron/resources/product-dist/app.js`
- `apps/desktop-electron/resources/product-dist/app.css`
- `apps/desktop-electron/src/main.ts`
- `apps/desktop-electron/src/preload.ts`
- `apps/desktop-electron/src/proxyServer.ts`
- `apps/desktop-electron/src/sidecars.ts`

