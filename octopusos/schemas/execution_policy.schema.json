{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://agentos.dev/schemas/execution_policy.schema.json",
  "$version": "1.0.0",
  "title": "ExecutionPolicy",
  "description": "Execution policy configuration",
  "type": "object",
  "required": ["schema_version", "mode"],
  "properties": {
    "schema_version": {
      "type": "string",
      "description": "ExecutionPolicy schema version (semver)",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "const": "1.0.0"
    },
    "mode": {
      "type": "string",
      "enum": ["interactive", "semi_auto", "full_auto"],
      "description": "Execution mode"
    },
    "question_budget": {
      "type": "integer",
      "minimum": 0,
      "description": "Maximum number of questions allowed"
    },
    "risk_profile": {
      "type": "string",
      "enum": ["safe", "aggressive_safe", "aggressive"],
      "description": "Risk tolerance profile"
    },
    "auto_fallback": {
      "type": "boolean",
      "description": "Whether to automatically use fallback when blocked"
    },
    "require_verification": {
      "type": "boolean",
      "description": "Whether verification step is mandatory"
    },
    "max_retries": {
      "type": "integer",
      "minimum": 0,
      "description": "Maximum retry attempts"
    },
    "timeout_seconds": {
      "type": "integer",
      "minimum": 0,
      "description": "Execution timeout in seconds"
    },
    "constraints": {
      "type": "object",
      "description": "Execution constraints",
      "properties": {
        "max_files_per_commit": {
          "type": "integer",
          "minimum": 1,
          "description": "Maximum files allowed in single commit"
        },
        "forbidden_operations": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Operations that are forbidden"
        },
        "allow_destructive": {
          "type": "boolean",
          "description": "Whether destructive operations are allowed"
        },
        "allow_bulk_changes": {
          "type": "boolean",
          "description": "Whether bulk changes are allowed"
        }
      }
    },
    "question_rules": {
      "type": "object",
      "description": "Rules for asking questions",
      "properties": {
        "allowed_types": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["clarification", "blocker", "decision_needed"]
          },
          "description": "Question types allowed in this mode"
        },
        "require_evidence": {
          "type": "boolean",
          "description": "Whether questions must have evidence references"
        },
        "min_evidence_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Minimum evidence items required per question"
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata",
      "additionalProperties": true
    }
  }
}
