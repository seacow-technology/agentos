{
  "id": "rule_r03_registry_only_references",
  "type": "rule",
  "version": "0.9.0",
  "status": "draft",
  "metadata": {
    "created_at": "2026-01-25T08:29:46.649495+00:00",
    "checksum": "cfd020336e9d27bab4e9b1b354b02dfa97997230de1684617d15aad1f2bd7707",
    "is_root": true,
    "tags": [
      "registry",
      "references",
      "integrity"
    ]
  },
  "spec": {
    "id": "rule_r03_registry_only_references",
    "type": "rule",
    "title": "Intent/plan must reference only registered content",
    "description": "Workflow/Agent/Command references in execution intent or plan must come from ContentRegistry. Fabricated IDs are forbidden.",
    "version": "0.9.0",
    "status": "active",
    "lineage": {
      "introduced_in": "v0.9",
      "derived_from": null,
      "supersedes": []
    },
    "constraints": {
      "execution": "forbidden"
    },
    "rule": {
      "severity": "error",
      "scope": {
        "applies_to_types": [
          "workflow",
          "agent",
          "command"
        ],
        "applies_to_risk": [
          "medium",
          "high",
          "critical"
        ],
        "applies_to_phases": [
          "analysis",
          "design",
          "implementation",
          "review"
        ]
      },
      "when": {
        "any_of": [
          {
            "content_reference_not_in_registry": true
          },
          {
            "content_id_fabricated": true
          }
        ]
      },
      "then": {
        "decision": "deny",
        "reason": "All content references must be registered in ContentRegistry",
        "required_changes": [
          "Verify content ID exists in registry",
          "Use ContentRegistry.get() to validate references",
          "Remove fabricated or invalid content IDs"
        ]
      },
      "evidence_required": [
        "registry_query_result",
        "content_reference_list"
      ]
    },
    "metadata": {
      "tags": [
        "registry",
        "references",
        "integrity"
      ],
      "author": "AgentOS Team"
    }
  }
}